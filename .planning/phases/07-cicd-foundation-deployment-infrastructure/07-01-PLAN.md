---
phase: 07-cicd-foundation-deployment-infrastructure
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .github/workflows/ci.yml
autonomous: true

must_haves:
  truths:
    - "CI runs automatically when developer pushes to feature branch"
    - "CI runs tests, lint, typecheck, and builds in parallel"
    - "CI completes within 5-10 minutes"
    - "CI uses npm caching for faster builds"
    - "CI prevents Storybook OOM with NODE_OPTIONS"
  artifacts:
    - path: ".github/workflows/ci.yml"
      provides: "CI workflow configuration"
      contains: "name: CI/CD Pipeline"
  key_links:
    - from: ".github/workflows/ci.yml"
      to: "package.json scripts"
      via: "npm run test, npm run lint, npm run build"
      pattern: "npm (ci|run)"
---

<objective>
Create the main CI workflow that runs tests, linting, type checking, and builds on every push to git-flow branches.

Purpose: Establish automated quality gates so developers get immediate feedback on code quality
Output: `.github/workflows/ci.yml` with parallel jobs for fast CI feedback
</objective>

<execution_context>
@/Users/alexanderfedin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/alexanderfedin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-cicd-foundation-deployment-infrastructure/07-CONTEXT.md
@.planning/phases/07-cicd-foundation-deployment-infrastructure/07-RESEARCH.md
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create GitHub workflows directory structure</name>
  <files>.github/workflows/</files>
  <action>
    Create the `.github/workflows/` directory if it doesn't exist.
    This is the standard location for GitHub Actions workflow files.
  </action>
  <verify>Directory exists: `ls -la .github/workflows/`</verify>
  <done>`.github/workflows/` directory exists</done>
</task>

<task type="auto">
  <name>Task 2: Create CI workflow with parallel jobs</name>
  <files>.github/workflows/ci.yml</files>
  <action>
    Create `.github/workflows/ci.yml` with the following configuration:

    **Workflow name:** "CI/CD Pipeline" (per CONTEXT.md decision)

    **Triggers:**
    - push to: main, develop, feature/**, release/**, hotfix/** (git-flow branches)
    - pull_request to: main, develop

    **Environment:**
    - NODE_OPTIONS: --max-old-space-size=4096 (prevents Storybook OOM per RESEARCH.md)

    **Jobs (all parallel, no dependencies):**

    1. `test` (name: "Run Tests")
       - actions/checkout@v6
       - actions/setup-node@v6 with node-version: '22', cache: 'npm'
       - npm ci
       - npm test

    2. `lint` (name: "Run Linting")
       - actions/checkout@v6
       - actions/setup-node@v6 with node-version: '22', cache: 'npm'
       - npm ci
       - npm run lint

    3. `typecheck` (name: "Type Check")
       - actions/checkout@v6
       - actions/setup-node@v6 with node-version: '22', cache: 'npm'
       - npm ci
       - npm run typecheck

    4. `build-library` (name: "Build Library")
       - actions/checkout@v6
       - actions/setup-node@v6 with node-version: '22', cache: 'npm'
       - npm ci
       - npm run build

    5. `build-storybook` (name: "Build Storybook")
       - actions/checkout@v6
       - actions/setup-node@v6 with node-version: '22', cache: 'npm'
       - npm ci
       - npm run build-storybook

    Use Node 22 (current LTS) per RESEARCH.md recommendation.
    Use actions/setup-node cache: 'npm' for automatic caching (CICD-07).
    All jobs run in parallel (no needs: dependencies between them).
  </action>
  <verify>
    Workflow syntax is valid: `cat .github/workflows/ci.yml`
    YAML is properly formatted with correct indentation
  </verify>
  <done>
    ci.yml exists with 5 parallel jobs (test, lint, typecheck, build-library, build-storybook)
    NODE_OPTIONS is set at workflow level
    npm caching is enabled via setup-node
    All git-flow branches trigger the workflow
  </done>
</task>

</tasks>

<verification>
1. `.github/workflows/ci.yml` exists
2. Workflow triggers on git-flow branches: main, develop, feature/**, release/**, hotfix/**
3. Workflow has NODE_OPTIONS environment variable
4. All 5 jobs have unique, descriptive names
5. Each job uses `cache: 'npm'` in setup-node
6. Jobs have no `needs:` dependencies (parallel execution)
</verification>

<success_criteria>
- CI workflow file created at `.github/workflows/ci.yml`
- Workflow will run tests, lint, typecheck, and both builds in parallel
- npm caching configured (CICD-07)
- NODE_OPTIONS set for memory (CICD-08)
- Ready for GitHub to execute on next push
</success_criteria>

<output>
After completion, create `.planning/phases/07-cicd-foundation-deployment-infrastructure/07-01-SUMMARY.md`
</output>
