---
phase: 06-developer-experience-and-build
plan: 04
type: execute
wave: 2
depends_on: ["06-02"]
files_modified:
  - .storybook/main.ts
  - .storybook/preview.ts
  - src/components/Card/Card.stories.tsx
  - src/components/Hand/Hand.stories.tsx
  - src/components/Deck/Deck.stories.tsx
  - src/components/CardStack/CardStack.stories.tsx
  - src/components/DropZone/DropZone.stories.tsx
autonomous: true

must_haves:
  truths:
    - "Running `npm run storybook` opens a browser with interactive card component examples"
    - "Storybook shows Getting Started, Layouts, and component documentation sections"
    - "Each component has autodocs generated from TypeScript props"
    - "Accessibility panel is available showing axe-core audit results"
  artifacts:
    - path: ".storybook/main.ts"
      provides: "Storybook 8.x config with react-vite framework and addons"
      contains: "@storybook/react-vite"
    - path: ".storybook/preview.ts"
      provides: "Global decorators, CSS variable imports, a11y config"
      contains: "variables.css"
    - path: "src/components/Card/Card.stories.tsx"
      provides: "Card component stories with interactive examples"
      contains: "meta"
    - path: "src/components/Hand/Hand.stories.tsx"
      provides: "Hand component stories"
      contains: "meta"
    - path: "src/components/Deck/Deck.stories.tsx"
      provides: "Deck component stories"
      contains: "meta"
  key_links:
    - from: ".storybook/main.ts"
      to: "src/**/*.stories.tsx"
      via: "stories glob"
      pattern: "stories.*src"
    - from: ".storybook/preview.ts"
      to: "src/styles/variables.css"
      via: "CSS import"
      pattern: "variables.css"
---

<objective>
Set up Storybook 8.x with react-vite framework and create core component stories following the use-case organized structure (Getting Started / Layouts).

Purpose: Interactive documentation (DX-01) that shows developers how to use every component with live examples, auto-generated prop tables, and accessibility auditing.
Output: .storybook/ configuration, stories for Card, Hand, Deck, CardStack, and DropZone components.
</objective>

<execution_context>
@/Users/alexanderfedin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/alexanderfedin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/06-developer-experience-and-build/06-RESEARCH.md
@.planning/phases/06-developer-experience-and-build/06-CONTEXT.md
@src/components/Card/Card.tsx
@src/components/Hand/Hand.tsx
@src/components/Deck/Deck.tsx
@src/components/CardStack/CardStack.tsx
@src/components/DropZone/DropZone.tsx
@src/index.ts
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize Storybook 8.x with react-vite framework</name>
  <files>.storybook/main.ts, .storybook/preview.ts, package.json</files>
  <action>
Initialize Storybook using the CLI (pin to version 8 to avoid getting 10.x):
```bash
npx storybook@8 init --type react_vite --skip-install
```

If the CLI auto-detection doesn't work well, manually create the config files:

Create `.storybook/main.ts`:
```typescript
import type { StorybookConfig } from '@storybook/react-vite';

const config: StorybookConfig = {
  stories: [
    '../src/**/*.mdx',
    '../src/**/*.stories.@(ts|tsx)',
  ],
  addons: [
    '@storybook/addon-essentials',
    '@storybook/addon-a11y',
    '@storybook/addon-interactions',
  ],
  framework: {
    name: '@storybook/react-vite',
    options: {},
  },
  docs: {
    defaultName: 'Documentation',
  },
};

export default config;
```

Create `.storybook/preview.ts`:
```typescript
import type { Preview } from '@storybook/react';
import '../src/styles/variables.css';

const preview: Preview = {
  parameters: {
    controls: {
      matchers: {
        color: /(background|color)$/i,
        date: /Date$/i,
      },
    },
    a11y: {
      test: { enable: true },
    },
  },
};

export default preview;
```

Install Storybook dependencies (if `npx storybook init` didn't install them):
```bash
npm install -D storybook@^8.5 @storybook/react-vite@^8.5 @storybook/addon-essentials@^8.5 @storybook/addon-a11y@^8.5 @storybook/addon-interactions@^8.5 @storybook/test@^8.5 @storybook/blocks@^8.5
```

Add scripts to package.json:
```json
"storybook": "storybook dev -p 6006",
"build-storybook": "storybook build"
```

Add to `.gitignore` or existing ignores:
- `storybook-static/`

Update the dts plugin exclude in `vite.config.ts` (if not already done in plan 03) to exclude stories:
```
exclude: ['src/**/*.test.ts', 'src/**/*.test.tsx', 'src/**/*.stories.tsx']
```

Verify with `npm run storybook` to confirm it starts.
  </action>
  <verify>Run `npm run storybook` (or `npx storybook dev -p 6006`) - Storybook should start and open in browser with no configuration errors. The a11y and interactions addons should appear in the panel.</verify>
  <done>Storybook 8.x starts successfully with react-vite framework, essentials/a11y/interactions addons, and global CSS variable import.</done>
</task>

<task type="auto">
  <name>Task 2: Create core component stories (Getting Started + Layouts)</name>
  <files>src/components/Card/Card.stories.tsx, src/components/Hand/Hand.stories.tsx, src/components/Deck/Deck.stories.tsx, src/components/CardStack/CardStack.stories.tsx, src/components/DropZone/DropZone.stories.tsx</files>
  <action>
Create stories for each core component following CSF3 format with use-case organization per CONTEXT decisions. Each story file should:
- Use `tags: ['autodocs']` for auto-generated prop documentation
- Include a component description in `parameters.docs.description.component`
- Show both simple and interactive examples

**Card stories** (`src/components/Card/Card.stories.tsx`):
- title: `'Getting Started/Card'`
- Stories: `AceOfSpades` (face up), `FaceDown`, `FlipAnimation` (with spring preset), `AllSuits` (show one card per suit), `Selected` (with selected styling), `WithClickHandler` (logs clicks via action)
- Use `parseCard('Aâ™ ')` or similar notation for card data
- Show `isFaceUp`, `spring`, `selected`, `onClick` props in action

**Hand stories** (`src/components/Hand/Hand.stories.tsx`):
- title: `'Layouts/Hand'`
- Stories: `FanLayout` (5-7 cards in fan), `SpreadLayout` (cards spread out), `StackLayout` (cards stacked), `LargeHand` (13 cards), `WithSelection` (cards can be selected), `EmptyHand`
- Use `allCards()` or `parseCard()` to create card arrays

**Deck stories** (`src/components/Deck/Deck.stories.tsx`):
- title: `'Layouts/Deck'`
- Stories: `FullDeck` (52 cards), `PartialDeck` (10 cards), `EmptyDeck`, `WithDrawAction` (interactive draw button)
- Show count badge, draw interactions

**CardStack stories** (`src/components/CardStack/CardStack.stories.tsx`):
- title: `'Layouts/CardStack'`
- Stories: `TopOnly` (only top card face up), `AllFaceUp`, `Cascading` (offset stack), `EmptyStack`

**DropZone stories** (`src/components/DropZone/DropZone.stories.tsx`):
- title: `'Layouts/DropZone'`
- Stories: `Default` (idle state), `WithPlaceholder`, `ActiveState` (simulated active visual), `ValidDropTarget`, `InvalidDropTarget`
- Note: DropZone visuals are controlled by prop, not actual DnD context here

Each story should import directly from the component file (not from barrel) for Storybook's component inference to work. Use `action()` from `@storybook/test` for callback props.
  </action>
  <verify>Run `npm run storybook` - all stories should render without errors. Navigate through Getting Started/Card and Layouts/* sections. Verify autodocs pages show prop tables.</verify>
  <done>Card, Hand, Deck, CardStack, and DropZone components have stories in Getting Started and Layouts categories. Each has multiple examples showing key features. Autodocs generate prop tables from TypeScript types.</done>
</task>

</tasks>

<verification>
1. `npm run storybook` starts without errors on port 6006
2. "Getting Started/Card" section shows card examples with flip, selection, click
3. "Layouts/" section shows Hand, Deck, CardStack, DropZone stories
4. Autodocs tab shows prop tables generated from TypeScript
5. Accessibility panel shows axe-core audit results per story
6. CSS custom properties from variables.css are loaded globally
</verification>

<success_criteria>
- Storybook 8.x runs with react-vite framework and all three addons (essentials, a11y, interactions)
- Core components (Card, Hand, Deck, CardStack, DropZone) have well-organized stories
- Stories are organized by use case: Getting Started > Layouts (per CONTEXT)
- Auto-generated documentation from TypeScript props is visible
</success_criteria>

<output>
After completion, create `.planning/phases/06-developer-experience-and-build/06-04-SUMMARY.md`
</output>
